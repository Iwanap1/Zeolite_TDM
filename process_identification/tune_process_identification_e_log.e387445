Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:09<00:09,  9.77s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  6.98s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  7.40s/it]
Map:   0%|          | 0/36 [00:00<?, ? examples/s]Map: 100%|██████████| 36/36 [00:00<00:00, 342.52 examples/s]Map: 100%|██████████| 36/36 [00:00<00:00, 336.60 examples/s]
Map:   0%|          | 0/9 [00:00<?, ? examples/s]Map: 100%|██████████| 9/9 [00:00<00:00, 284.73 examples/s]
/rds/general/user/iap23/home/tdm/scripts/fine-tune-phi.py:107: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
  0%|          | 0/360 [00:00<?, ?it/s]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
You are not running the flash-attention implementation, expect numerical differences.
  0%|          | 1/360 [00:03<23:01,  3.85s/it]  1%|          | 2/360 [00:05<15:02,  2.52s/it]  1%|          | 3/360 [00:07<12:29,  2.10s/it]  1%|          | 4/360 [00:08<11:16,  1.90s/it]  1%|▏         | 5/360 [00:10<10:35,  1.79s/it]  2%|▏         | 6/360 [00:11<10:09,  1.72s/it]  2%|▏         | 7/360 [00:13<09:53,  1.68s/it]  2%|▏         | 8/360 [00:15<09:41,  1.65s/it]  2%|▎         | 9/360 [00:16<09:33,  1.64s/it]  3%|▎         | 10/360 [00:18<09:27,  1.62s/it]                                                  3%|▎         | 10/360 [00:18<09:27,  1.62s/it]  3%|▎         | 11/360 [00:19<09:23,  1.61s/it]  3%|▎         | 12/360 [00:21<09:19,  1.61s/it]  4%|▎         | 13/360 [00:22<09:16,  1.60s/it]  4%|▍         | 14/360 [00:24<09:14,  1.60s/it]  4%|▍         | 15/360 [00:26<09:12,  1.60s/it]  4%|▍         | 16/360 [00:27<09:10,  1.60s/it]  5%|▍         | 17/360 [00:29<09:08,  1.60s/it]  5%|▌         | 18/360 [00:30<09:06,  1.60s/it]  5%|▌         | 19/360 [00:32<09:04,  1.60s/it]  6%|▌         | 20/360 [00:34<09:02,  1.60s/it]                                                  6%|▌         | 20/360 [00:34<09:02,  1.60s/it]  6%|▌         | 21/360 [00:35<09:01,  1.60s/it]  6%|▌         | 22/360 [00:37<09:14,  1.64s/it]  6%|▋         | 23/360 [00:39<09:08,  1.63s/it]  7%|▋         | 24/360 [00:40<09:03,  1.62s/it]  7%|▋         | 25/360 [00:42<09:00,  1.61s/it]  7%|▋         | 26/360 [00:43<08:56,  1.61s/it]  8%|▊         | 27/360 [00:45<08:54,  1.60s/it]  8%|▊         | 28/360 [00:47<08:51,  1.60s/it]  8%|▊         | 29/360 [00:48<08:50,  1.60s/it]  8%|▊         | 30/360 [00:50<08:48,  1.60s/it]                                                  8%|▊         | 30/360 [00:50<08:48,  1.60s/it]  9%|▊         | 31/360 [00:51<08:46,  1.60s/it]  9%|▉         | 32/360 [00:53<08:44,  1.60s/it]  9%|▉         | 33/360 [00:55<08:42,  1.60s/it]  9%|▉         | 34/360 [00:56<08:40,  1.60s/it] 10%|▉         | 35/360 [00:58<08:39,  1.60s/it] 10%|█         | 36/360 [00:59<08:41,  1.61s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A                                                
                                             [A 10%|█         | 36/360 [01:04<08:41,  1.61s/it]
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 10%|█         | 37/360 [01:06<16:48,  3.12s/it] 11%|█         | 38/360 [01:08<14:18,  2.67s/it] 11%|█         | 39/360 [01:09<12:32,  2.35s/it] 11%|█         | 40/360 [01:11<11:18,  2.12s/it]                                                 11%|█         | 40/360 [01:11<11:18,  2.12s/it] 11%|█▏        | 41/360 [01:12<10:26,  1.96s/it] 12%|█▏        | 42/360 [01:14<09:49,  1.85s/it] 12%|█▏        | 43/360 [01:16<09:36,  1.82s/it] 12%|█▏        | 44/360 [01:17<09:13,  1.75s/it] 12%|█▎        | 45/360 [01:19<08:57,  1.71s/it] 13%|█▎        | 46/360 [01:21<08:45,  1.67s/it] 13%|█▎        | 47/360 [01:22<08:37,  1.65s/it] 13%|█▎        | 48/360 [01:24<08:30,  1.64s/it] 14%|█▎        | 49/360 [01:25<08:25,  1.63s/it] 14%|█▍        | 50/360 [01:27<08:24,  1.63s/it]                                                 14%|█▍        | 50/360 [01:27<08:24,  1.63s/it] 14%|█▍        | 51/360 [01:29<08:20,  1.62s/it] 14%|█▍        | 52/360 [01:30<08:17,  1.61s/it] 15%|█▍        | 53/360 [01:32<08:14,  1.61s/it] 15%|█▌        | 54/360 [01:33<08:11,  1.61s/it] 15%|█▌        | 55/360 [01:35<08:09,  1.61s/it] 16%|█▌        | 56/360 [01:37<08:07,  1.60s/it] 16%|█▌        | 57/360 [01:38<08:05,  1.60s/it] 16%|█▌        | 58/360 [01:40<08:03,  1.60s/it] 16%|█▋        | 59/360 [01:41<08:02,  1.60s/it] 17%|█▋        | 60/360 [01:43<08:00,  1.60s/it]                                                 17%|█▋        | 60/360 [01:43<08:00,  1.60s/it] 17%|█▋        | 61/360 [01:45<07:58,  1.60s/it] 17%|█▋        | 62/360 [01:46<07:56,  1.60s/it] 18%|█▊        | 63/360 [01:48<07:55,  1.60s/it] 18%|█▊        | 64/360 [01:49<07:53,  1.60s/it] 18%|█▊        | 65/360 [01:51<07:52,  1.60s/it] 18%|█▊        | 66/360 [01:53<07:50,  1.60s/it] 19%|█▊        | 67/360 [01:54<07:49,  1.60s/it] 19%|█▉        | 68/360 [01:56<07:47,  1.60s/it] 19%|█▉        | 69/360 [01:57<07:46,  1.60s/it] 19%|█▉        | 70/360 [01:59<07:44,  1.60s/it]                                                 19%|█▉        | 70/360 [01:59<07:44,  1.60s/it] 20%|█▉        | 71/360 [02:01<07:42,  1.60s/it] 20%|██        | 72/360 [02:02<07:46,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.36it/s][A                                                
                                             [A 20%|██        | 72/360 [02:07<07:46,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.36it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 20%|██        | 73/360 [02:09<14:56,  3.12s/it] 21%|██        | 74/360 [02:11<12:42,  2.67s/it] 21%|██        | 75/360 [02:12<11:09,  2.35s/it] 21%|██        | 76/360 [02:14<10:03,  2.12s/it] 21%|██▏       | 77/360 [02:15<09:17,  1.97s/it] 22%|██▏       | 78/360 [02:17<08:44,  1.86s/it] 22%|██▏       | 79/360 [02:19<08:21,  1.78s/it] 22%|██▏       | 80/360 [02:20<08:03,  1.73s/it]                                                 22%|██▏       | 80/360 [02:20<08:03,  1.73s/it] 22%|██▎       | 81/360 [02:22<07:51,  1.69s/it] 23%|██▎       | 82/360 [02:23<07:42,  1.66s/it] 23%|██▎       | 83/360 [02:25<07:35,  1.64s/it] 23%|██▎       | 84/360 [02:27<07:29,  1.63s/it] 24%|██▎       | 85/360 [02:28<07:29,  1.63s/it] 24%|██▍       | 86/360 [02:30<07:24,  1.62s/it] 24%|██▍       | 87/360 [02:31<07:21,  1.62s/it] 24%|██▍       | 88/360 [02:33<07:18,  1.61s/it] 25%|██▍       | 89/360 [02:35<07:15,  1.61s/it] 25%|██▌       | 90/360 [02:36<07:13,  1.61s/it]                                                 25%|██▌       | 90/360 [02:36<07:13,  1.61s/it] 25%|██▌       | 91/360 [02:38<07:11,  1.60s/it] 26%|██▌       | 92/360 [02:39<07:09,  1.60s/it] 26%|██▌       | 93/360 [02:41<07:08,  1.60s/it] 26%|██▌       | 94/360 [02:43<07:06,  1.60s/it] 26%|██▋       | 95/360 [02:44<07:04,  1.60s/it] 27%|██▋       | 96/360 [02:46<07:03,  1.60s/it] 27%|██▋       | 97/360 [02:47<07:01,  1.60s/it] 27%|██▋       | 98/360 [02:49<06:59,  1.60s/it] 28%|██▊       | 99/360 [02:51<06:57,  1.60s/it] 28%|██▊       | 100/360 [02:52<06:56,  1.60s/it]                                                  28%|██▊       | 100/360 [02:52<06:56,  1.60s/it] 28%|██▊       | 101/360 [02:54<06:54,  1.60s/it] 28%|██▊       | 102/360 [02:55<06:53,  1.60s/it] 29%|██▊       | 103/360 [02:57<06:51,  1.60s/it] 29%|██▉       | 104/360 [02:59<06:50,  1.60s/it] 29%|██▉       | 105/360 [03:00<06:48,  1.60s/it] 29%|██▉       | 106/360 [03:02<06:46,  1.60s/it] 30%|██▉       | 107/360 [03:03<06:45,  1.60s/it] 30%|███       | 108/360 [03:05<06:48,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.35it/s][A                                                 
                                             [A 30%|███       | 108/360 [03:09<06:48,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.35it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 30%|███       | 109/360 [03:12<13:24,  3.21s/it] 31%|███       | 110/360 [03:14<11:21,  2.73s/it]                                                  31%|███       | 110/360 [03:14<11:21,  2.73s/it] 31%|███       | 111/360 [03:15<09:54,  2.39s/it] 31%|███       | 112/360 [03:17<08:53,  2.15s/it] 31%|███▏      | 113/360 [03:18<08:10,  1.99s/it] 32%|███▏      | 114/360 [03:20<07:40,  1.87s/it] 32%|███▏      | 115/360 [03:22<07:18,  1.79s/it] 32%|███▏      | 116/360 [03:23<07:03,  1.73s/it] 32%|███▎      | 117/360 [03:25<06:51,  1.69s/it] 33%|███▎      | 118/360 [03:26<06:43,  1.67s/it] 33%|███▎      | 119/360 [03:28<06:37,  1.65s/it] 33%|███▎      | 120/360 [03:30<06:32,  1.64s/it]                                                  33%|███▎      | 120/360 [03:30<06:32,  1.64s/it] 34%|███▎      | 121/360 [03:31<06:28,  1.63s/it] 34%|███▍      | 122/360 [03:33<06:25,  1.62s/it] 34%|███▍      | 123/360 [03:34<06:22,  1.61s/it] 34%|███▍      | 124/360 [03:36<06:19,  1.61s/it] 35%|███▍      | 125/360 [03:38<06:17,  1.61s/it] 35%|███▌      | 126/360 [03:39<06:15,  1.61s/it] 35%|███▌      | 127/360 [03:41<06:13,  1.60s/it] 36%|███▌      | 128/360 [03:42<06:11,  1.60s/it] 36%|███▌      | 129/360 [03:44<06:10,  1.60s/it] 36%|███▌      | 130/360 [03:46<06:08,  1.60s/it]                                                  36%|███▌      | 130/360 [03:46<06:08,  1.60s/it] 36%|███▋      | 131/360 [03:47<06:07,  1.60s/it] 37%|███▋      | 132/360 [03:49<06:05,  1.60s/it] 37%|███▋      | 133/360 [03:50<06:03,  1.60s/it] 37%|███▋      | 134/360 [03:52<06:02,  1.60s/it] 38%|███▊      | 135/360 [03:54<06:00,  1.60s/it] 38%|███▊      | 136/360 [03:55<05:58,  1.60s/it] 38%|███▊      | 137/360 [03:57<05:57,  1.60s/it] 38%|███▊      | 138/360 [03:58<05:55,  1.60s/it] 39%|███▊      | 139/360 [04:00<05:54,  1.60s/it] 39%|███▉      | 140/360 [04:02<05:52,  1.60s/it]                                                  39%|███▉      | 140/360 [04:02<05:52,  1.60s/it] 39%|███▉      | 141/360 [04:03<05:51,  1.61s/it] 39%|███▉      | 142/360 [04:05<05:49,  1.60s/it] 40%|███▉      | 143/360 [04:06<05:47,  1.60s/it] 40%|████      | 144/360 [04:08<05:50,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A                                                 
                                             [A 40%|████      | 144/360 [04:13<05:50,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 40%|████      | 145/360 [04:15<11:09,  3.11s/it] 41%|████      | 146/360 [04:16<09:29,  2.66s/it] 41%|████      | 147/360 [04:18<08:19,  2.34s/it] 41%|████      | 148/360 [04:20<07:29,  2.12s/it] 41%|████▏     | 149/360 [04:21<06:54,  1.97s/it] 42%|████▏     | 150/360 [04:23<06:29,  1.86s/it]                                                  42%|████▏     | 150/360 [04:23<06:29,  1.86s/it] 42%|████▏     | 151/360 [04:24<06:12,  1.78s/it] 42%|████▏     | 152/360 [04:26<05:59,  1.73s/it] 42%|████▎     | 153/360 [04:28<05:49,  1.69s/it] 43%|████▎     | 154/360 [04:29<05:42,  1.66s/it] 43%|████▎     | 155/360 [04:31<05:45,  1.69s/it] 43%|████▎     | 156/360 [04:33<05:39,  1.66s/it] 44%|████▎     | 157/360 [04:34<05:33,  1.64s/it] 44%|████▍     | 158/360 [04:36<05:29,  1.63s/it] 44%|████▍     | 159/360 [04:37<05:25,  1.62s/it] 44%|████▍     | 160/360 [04:39<05:23,  1.62s/it]                                                  44%|████▍     | 160/360 [04:39<05:23,  1.62s/it] 45%|████▍     | 161/360 [04:41<05:20,  1.61s/it] 45%|████▌     | 162/360 [04:42<05:18,  1.61s/it] 45%|████▌     | 163/360 [04:44<05:16,  1.61s/it] 46%|████▌     | 164/360 [04:45<05:15,  1.61s/it] 46%|████▌     | 165/360 [04:47<05:13,  1.61s/it] 46%|████▌     | 166/360 [04:49<05:11,  1.60s/it] 46%|████▋     | 167/360 [04:50<05:09,  1.60s/it] 47%|████▋     | 168/360 [04:52<05:07,  1.60s/it] 47%|████▋     | 169/360 [04:53<05:05,  1.60s/it] 47%|████▋     | 170/360 [04:55<05:04,  1.60s/it]                                                  47%|████▋     | 170/360 [04:55<05:04,  1.60s/it] 48%|████▊     | 171/360 [04:57<05:03,  1.60s/it] 48%|████▊     | 172/360 [04:58<05:01,  1.60s/it] 48%|████▊     | 173/360 [05:00<04:59,  1.60s/it] 48%|████▊     | 174/360 [05:01<04:58,  1.60s/it] 49%|████▊     | 175/360 [05:03<04:56,  1.60s/it] 49%|████▉     | 176/360 [05:05<04:54,  1.60s/it] 49%|████▉     | 177/360 [05:06<04:53,  1.60s/it] 49%|████▉     | 178/360 [05:08<04:51,  1.60s/it] 50%|████▉     | 179/360 [05:09<04:49,  1.60s/it] 50%|█████     | 180/360 [05:11<04:52,  1.62s/it]                                                  50%|█████     | 180/360 [05:11<04:52,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A                                                 
                                             [A 50%|█████     | 180/360 [05:15<04:52,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 50%|█████     | 181/360 [05:18<09:18,  3.12s/it] 51%|█████     | 182/360 [05:19<07:55,  2.67s/it] 51%|█████     | 183/360 [05:21<06:56,  2.35s/it] 51%|█████     | 184/360 [05:22<06:14,  2.13s/it] 51%|█████▏    | 185/360 [05:24<05:47,  1.99s/it] 52%|█████▏    | 186/360 [05:26<05:25,  1.87s/it] 52%|█████▏    | 187/360 [05:27<05:09,  1.79s/it] 52%|█████▏    | 188/360 [05:29<04:58,  1.74s/it] 52%|█████▎    | 189/360 [05:31<04:49,  1.70s/it] 53%|█████▎    | 190/360 [05:32<04:43,  1.67s/it]                                                  53%|█████▎    | 190/360 [05:32<04:43,  1.67s/it] 53%|█████▎    | 191/360 [05:34<04:38,  1.65s/it] 53%|█████▎    | 192/360 [05:35<04:34,  1.63s/it] 54%|█████▎    | 193/360 [05:37<04:31,  1.62s/it] 54%|█████▍    | 194/360 [05:39<04:28,  1.62s/it] 54%|█████▍    | 195/360 [05:40<04:26,  1.61s/it] 54%|█████▍    | 196/360 [05:42<04:25,  1.62s/it] 55%|█████▍    | 197/360 [05:43<04:23,  1.62s/it] 55%|█████▌    | 198/360 [05:45<04:21,  1.61s/it] 55%|█████▌    | 199/360 [05:47<04:19,  1.61s/it] 56%|█████▌    | 200/360 [05:48<04:17,  1.61s/it]                                                  56%|█████▌    | 200/360 [05:48<04:17,  1.61s/it] 56%|█████▌    | 201/360 [05:50<04:16,  1.61s/it] 56%|█████▌    | 202/360 [05:51<04:13,  1.61s/it] 56%|█████▋    | 203/360 [05:53<04:12,  1.61s/it] 57%|█████▋    | 204/360 [05:55<04:10,  1.60s/it] 57%|█████▋    | 205/360 [05:56<04:08,  1.60s/it] 57%|█████▋    | 206/360 [05:58<04:06,  1.60s/it] 57%|█████▊    | 207/360 [05:59<04:05,  1.60s/it] 58%|█████▊    | 208/360 [06:01<04:03,  1.60s/it] 58%|█████▊    | 209/360 [06:03<04:01,  1.60s/it] 58%|█████▊    | 210/360 [06:04<04:00,  1.60s/it]                                                  58%|█████▊    | 210/360 [06:04<04:00,  1.60s/it] 59%|█████▊    | 211/360 [06:06<03:58,  1.60s/it] 59%|█████▉    | 212/360 [06:07<03:57,  1.60s/it] 59%|█████▉    | 213/360 [06:09<03:55,  1.60s/it] 59%|█████▉    | 214/360 [06:11<03:53,  1.60s/it] 60%|█████▉    | 215/360 [06:12<03:52,  1.60s/it] 60%|██████    | 216/360 [06:14<03:53,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.38it/s][A                                                 
                                             [A 60%|██████    | 216/360 [06:18<03:53,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.38it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 60%|██████    | 217/360 [06:21<07:26,  3.12s/it] 61%|██████    | 218/360 [06:22<06:18,  2.67s/it] 61%|██████    | 219/360 [06:24<05:33,  2.36s/it] 61%|██████    | 220/360 [06:25<04:58,  2.13s/it]                                                  61%|██████    | 220/360 [06:25<04:58,  2.13s/it] 61%|██████▏   | 221/360 [06:27<04:34,  1.98s/it] 62%|██████▏   | 222/360 [06:29<04:17,  1.86s/it] 62%|██████▏   | 223/360 [06:30<04:04,  1.79s/it] 62%|██████▏   | 224/360 [06:32<04:05,  1.80s/it] 62%|██████▎   | 225/360 [06:34<03:55,  1.74s/it] 63%|██████▎   | 226/360 [06:35<03:47,  1.70s/it] 63%|██████▎   | 227/360 [06:37<03:42,  1.67s/it] 63%|██████▎   | 228/360 [06:38<03:37,  1.65s/it] 64%|██████▎   | 229/360 [06:40<03:34,  1.64s/it] 64%|██████▍   | 230/360 [06:42<03:31,  1.63s/it]                                                  64%|██████▍   | 230/360 [06:42<03:31,  1.63s/it] 64%|██████▍   | 231/360 [06:43<03:29,  1.62s/it] 64%|██████▍   | 232/360 [06:45<03:26,  1.62s/it] 65%|██████▍   | 233/360 [06:46<03:24,  1.61s/it] 65%|██████▌   | 234/360 [06:48<03:22,  1.61s/it] 65%|██████▌   | 235/360 [06:50<03:20,  1.61s/it] 66%|██████▌   | 236/360 [06:51<03:19,  1.61s/it] 66%|██████▌   | 237/360 [06:53<03:17,  1.60s/it] 66%|██████▌   | 238/360 [06:54<03:15,  1.60s/it] 66%|██████▋   | 239/360 [06:56<03:13,  1.60s/it] 67%|██████▋   | 240/360 [06:58<03:12,  1.60s/it]                                                  67%|██████▋   | 240/360 [06:58<03:12,  1.60s/it] 67%|██████▋   | 241/360 [06:59<03:10,  1.60s/it] 67%|██████▋   | 242/360 [07:01<03:09,  1.60s/it] 68%|██████▊   | 243/360 [07:03<03:07,  1.60s/it] 68%|██████▊   | 244/360 [07:04<03:05,  1.60s/it] 68%|██████▊   | 245/360 [07:06<03:04,  1.60s/it] 68%|██████▊   | 246/360 [07:07<03:02,  1.60s/it] 69%|██████▊   | 247/360 [07:09<03:01,  1.61s/it] 69%|██████▉   | 248/360 [07:11<02:59,  1.61s/it] 69%|██████▉   | 249/360 [07:12<02:58,  1.61s/it] 69%|██████▉   | 250/360 [07:14<02:56,  1.60s/it]                                                  69%|██████▉   | 250/360 [07:14<02:56,  1.60s/it] 70%|██████▉   | 251/360 [07:15<02:54,  1.60s/it] 70%|███████   | 252/360 [07:17<02:55,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A                                                 
                                             [A 70%|███████   | 252/360 [07:21<02:55,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 70%|███████   | 253/360 [07:24<05:34,  3.13s/it] 71%|███████   | 254/360 [07:25<04:42,  2.67s/it] 71%|███████   | 255/360 [07:27<04:06,  2.35s/it] 71%|███████   | 256/360 [07:28<03:40,  2.12s/it] 71%|███████▏  | 257/360 [07:30<03:22,  1.97s/it] 72%|███████▏  | 258/360 [07:32<03:09,  1.86s/it] 72%|███████▏  | 259/360 [07:33<03:00,  1.78s/it] 72%|███████▏  | 260/360 [07:35<02:52,  1.73s/it]                                                  72%|███████▏  | 260/360 [07:35<02:52,  1.73s/it] 72%|███████▎  | 261/360 [07:36<02:47,  1.69s/it] 73%|███████▎  | 262/360 [07:38<02:49,  1.73s/it] 73%|███████▎  | 263/360 [07:40<02:43,  1.69s/it] 73%|███████▎  | 264/360 [07:41<02:39,  1.66s/it] 74%|███████▎  | 265/360 [07:43<02:36,  1.64s/it] 74%|███████▍  | 266/360 [07:45<02:34,  1.64s/it] 74%|███████▍  | 267/360 [07:46<02:31,  1.63s/it] 74%|███████▍  | 268/360 [07:48<02:29,  1.62s/it] 75%|███████▍  | 269/360 [07:50<02:26,  1.61s/it] 75%|███████▌  | 270/360 [07:51<02:25,  1.61s/it]                                                  75%|███████▌  | 270/360 [07:51<02:25,  1.61s/it] 75%|███████▌  | 271/360 [07:53<02:23,  1.61s/it] 76%|███████▌  | 272/360 [07:54<02:21,  1.61s/it] 76%|███████▌  | 273/360 [07:56<02:19,  1.61s/it] 76%|███████▌  | 274/360 [07:58<02:17,  1.60s/it] 76%|███████▋  | 275/360 [07:59<02:16,  1.60s/it] 77%|███████▋  | 276/360 [08:01<02:14,  1.60s/it] 77%|███████▋  | 277/360 [08:02<02:12,  1.60s/it] 77%|███████▋  | 278/360 [08:04<02:11,  1.61s/it] 78%|███████▊  | 279/360 [08:06<02:10,  1.61s/it] 78%|███████▊  | 280/360 [08:07<02:08,  1.61s/it]                                                  78%|███████▊  | 280/360 [08:07<02:08,  1.61s/it] 78%|███████▊  | 281/360 [08:09<02:06,  1.60s/it] 78%|███████▊  | 282/360 [08:10<02:05,  1.61s/it] 79%|███████▊  | 283/360 [08:12<02:03,  1.60s/it] 79%|███████▉  | 284/360 [08:14<02:01,  1.60s/it] 79%|███████▉  | 285/360 [08:15<02:00,  1.60s/it] 79%|███████▉  | 286/360 [08:17<01:58,  1.60s/it] 80%|███████▉  | 287/360 [08:18<01:56,  1.60s/it] 80%|████████  | 288/360 [08:20<01:57,  1.63s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A                                                 
                                             [A 80%|████████  | 288/360 [08:24<01:57,  1.63s/it]
100%|██████████| 2/2 [00:01<00:00,  1.37it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 80%|████████  | 289/360 [08:27<03:41,  3.12s/it] 81%|████████  | 290/360 [08:28<03:06,  2.66s/it]                                                  81%|████████  | 290/360 [08:28<03:06,  2.66s/it] 81%|████████  | 291/360 [08:30<02:41,  2.34s/it] 81%|████████  | 292/360 [08:31<02:24,  2.12s/it] 81%|████████▏ | 293/360 [08:33<02:11,  1.96s/it] 82%|████████▏ | 294/360 [08:35<02:02,  1.85s/it] 82%|████████▏ | 295/360 [08:36<01:55,  1.78s/it] 82%|████████▏ | 296/360 [08:38<01:50,  1.73s/it] 82%|████████▎ | 297/360 [08:39<01:46,  1.69s/it] 83%|████████▎ | 298/360 [08:41<01:42,  1.66s/it] 83%|████████▎ | 299/360 [08:43<01:40,  1.64s/it] 83%|████████▎ | 300/360 [08:44<01:37,  1.63s/it]                                                  83%|████████▎ | 300/360 [08:44<01:37,  1.63s/it] 84%|████████▎ | 301/360 [08:46<01:35,  1.62s/it] 84%|████████▍ | 302/360 [08:47<01:33,  1.62s/it] 84%|████████▍ | 303/360 [08:49<01:31,  1.61s/it] 84%|████████▍ | 304/360 [08:51<01:30,  1.61s/it] 85%|████████▍ | 305/360 [08:52<01:28,  1.61s/it] 85%|████████▌ | 306/360 [08:54<01:26,  1.61s/it] 85%|████████▌ | 307/360 [08:55<01:25,  1.60s/it] 86%|████████▌ | 308/360 [08:57<01:25,  1.64s/it] 86%|████████▌ | 309/360 [08:59<01:23,  1.63s/it] 86%|████████▌ | 310/360 [09:00<01:21,  1.62s/it]                                                  86%|████████▌ | 310/360 [09:00<01:21,  1.62s/it] 86%|████████▋ | 311/360 [09:02<01:19,  1.62s/it] 87%|████████▋ | 312/360 [09:04<01:17,  1.61s/it] 87%|████████▋ | 313/360 [09:05<01:15,  1.61s/it] 87%|████████▋ | 314/360 [09:07<01:13,  1.61s/it] 88%|████████▊ | 315/360 [09:08<01:12,  1.60s/it] 88%|████████▊ | 316/360 [09:10<01:10,  1.60s/it] 88%|████████▊ | 317/360 [09:12<01:08,  1.60s/it] 88%|████████▊ | 318/360 [09:13<01:07,  1.60s/it] 89%|████████▊ | 319/360 [09:15<01:05,  1.60s/it] 89%|████████▉ | 320/360 [09:16<01:04,  1.60s/it]                                                  89%|████████▉ | 320/360 [09:16<01:04,  1.60s/it] 89%|████████▉ | 321/360 [09:18<01:02,  1.60s/it] 89%|████████▉ | 322/360 [09:20<01:00,  1.60s/it] 90%|████████▉ | 323/360 [09:21<00:59,  1.60s/it] 90%|█████████ | 324/360 [09:23<00:58,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.36it/s][A                                                 
                                             [A 90%|█████████ | 324/360 [09:27<00:58,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.36it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
 90%|█████████ | 325/360 [09:30<01:49,  3.12s/it] 91%|█████████ | 326/360 [09:31<01:30,  2.66s/it] 91%|█████████ | 327/360 [09:33<01:17,  2.35s/it] 91%|█████████ | 328/360 [09:34<01:07,  2.12s/it] 91%|█████████▏| 329/360 [09:36<01:00,  1.97s/it] 92%|█████████▏| 330/360 [09:38<00:56,  1.89s/it]                                                  92%|█████████▏| 330/360 [09:38<00:56,  1.89s/it] 92%|█████████▏| 331/360 [09:39<00:52,  1.80s/it] 92%|█████████▏| 332/360 [09:41<00:48,  1.74s/it] 92%|█████████▎| 333/360 [09:42<00:45,  1.70s/it] 93%|█████████▎| 334/360 [09:44<00:43,  1.67s/it] 93%|█████████▎| 335/360 [09:46<00:41,  1.65s/it] 93%|█████████▎| 336/360 [09:47<00:39,  1.64s/it] 94%|█████████▎| 337/360 [09:49<00:37,  1.63s/it] 94%|█████████▍| 338/360 [09:50<00:35,  1.62s/it] 94%|█████████▍| 339/360 [09:52<00:33,  1.61s/it] 94%|█████████▍| 340/360 [09:54<00:32,  1.61s/it]                                                  94%|█████████▍| 340/360 [09:54<00:32,  1.61s/it] 95%|█████████▍| 341/360 [09:55<00:30,  1.61s/it] 95%|█████████▌| 342/360 [09:57<00:28,  1.61s/it] 95%|█████████▌| 343/360 [09:58<00:27,  1.61s/it] 96%|█████████▌| 344/360 [10:00<00:25,  1.61s/it] 96%|█████████▌| 345/360 [10:02<00:24,  1.60s/it] 96%|█████████▌| 346/360 [10:03<00:22,  1.60s/it] 96%|█████████▋| 347/360 [10:05<00:20,  1.60s/it] 97%|█████████▋| 348/360 [10:06<00:19,  1.60s/it] 97%|█████████▋| 349/360 [10:08<00:17,  1.60s/it] 97%|█████████▋| 350/360 [10:10<00:16,  1.60s/it]                                                  97%|█████████▋| 350/360 [10:10<00:16,  1.60s/it] 98%|█████████▊| 351/360 [10:11<00:14,  1.60s/it] 98%|█████████▊| 352/360 [10:13<00:12,  1.60s/it] 98%|█████████▊| 353/360 [10:14<00:11,  1.60s/it] 98%|█████████▊| 354/360 [10:16<00:09,  1.60s/it] 99%|█████████▊| 355/360 [10:18<00:08,  1.60s/it] 99%|█████████▉| 356/360 [10:19<00:06,  1.60s/it] 99%|█████████▉| 357/360 [10:21<00:04,  1.60s/it] 99%|█████████▉| 358/360 [10:22<00:03,  1.60s/it]100%|█████████▉| 359/360 [10:24<00:01,  1.60s/it]100%|██████████| 360/360 [10:26<00:00,  1.62s/it]                                                 100%|██████████| 360/360 [10:26<00:00,  1.62s/it]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)

  0%|          | 0/2 [00:00<?, ?it/s][A
100%|██████████| 2/2 [00:01<00:00,  1.34it/s][A                                                 
                                             [A100%|██████████| 360/360 [10:30<00:00,  1.62s/it]
100%|██████████| 2/2 [00:01<00:00,  1.34it/s][A
                                             [A/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
                                                 100%|██████████| 360/360 [10:31<00:00,  1.62s/it]100%|██████████| 360/360 [10:31<00:00,  1.75s/it]
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/other.py:1110: UserWarning: Unable to fetch remote file due to the following error 429 Client Error: Too Many Requests for url: https://huggingface.co/microsoft/Phi-3-mini-4k-instruct/resolve/main/config.json - silently ignoring the lookup for the file config.json in microsoft/Phi-3-mini-4k-instruct.
  warnings.warn(
/rds/general/user/iap23/home/miniforge3/envs/phi3-qlora-flash/lib/python3.10/site-packages/peft/utils/save_and_load.py:236: UserWarning: Could not find a config file in microsoft/Phi-3-mini-4k-instruct - will assume that the vocabulary was not modified.
  warnings.warn(
